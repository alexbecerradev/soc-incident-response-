# Follina (CVE-2022-30190) ‚Äì Incident Analysis

## üìå Overview
This analysis covers the investigation of **Follina (CVE-2022-30190)**, a Microsoft Office remote code execution vulnerability abused via malicious documents.  
The objective was to identify the infection vector, analyze attacker behavior, and extract relevant indicators of compromise (IOCs).

---

## üß© Initial Alert / Scenario
- Suspicious Microsoft Office document execution
- Possible exploitation of MSDT (Microsoft Support Diagnostic Tool)
- No macros required for exploitation

---

## üîç Investigation Steps
The investigation started with a suspicious Microsoft Word document (sample.doc).
The file hash was submitted to a malware analysis platform, where multiple security vendors flagged the document as malicious and associated it with CVE-2022-30190 (Follina).

This confirmed that the document was exploiting a known Microsoft Office remote code execution vulnerability.

![Alert details](/images/follina(4).png)

The document was treated as an Office Open XML (OOXML) file and extracted for manual inspection.

Key directories identified:

word/

word/_rels/

XML configuration files (document.xml, settings.xml, webSettings.xml)

This structure confirmed that the file was not a legacy binary document, but a modern OOXML-based file.

![Alert details](images/follina(2).png)

The file word/_rels/document.xml.rels was analyzed to understand external relationships.

During inspection:

An external relationship was identified

The relationship referenced a remote HTML resource

The relationship type was linked to an embedded object

This behavior is abnormal for benign documents and is commonly abused in Follina attacks.

![Alert details](images/follina(3).png)

The external relationship pointed to a remote HTML file hosted on an attacker-controlled server.

This HTML file is used to:

Trigger the ms-msdt: URI scheme

Invoke Microsoft Support Diagnostic Tool (MSDT)

Achieve code execution without requiring macros

This confirms exploitation via MSDT abuse, which is the core technique used in Follina.

![Alert details](images/follina(1).png)

### 1Ô∏è‚É£ Document Analysis
- Identified a malicious Office document as the initial attack vector
- Observed external references inside the document pointing to a remote resource
- Confirmed the document leverages a **ms-msdt:** URI scheme

---

### 2Ô∏è‚É£ Process Execution Analysis
- Office application (`winword.exe`) spawned a child process
- Detected execution of `msdt.exe`, which is abnormal in normal document usage
- Process tree analysis confirmed exploitation flow:
